{
  "data": {
    "nodes": [
      {
        "id": "TextInput-USERID",
        "type": "genericNode",
        "position": {"x": 100, "y": 300},
        "data": {
          "id": "TextInput-USERID",
          "display_name": "User ID Input",
          "description": "Enter a trial user ID to look up",
          "type": "TextInput",
          "node": {
            "base_classes": ["Message"],
            "display_name": "User ID Input",
            "description": "The trial user ID to analyze",
            "template": {
              "_type": "Component",
              "input_value": {
                "type": "str",
                "required": true,
                "show": true,
                "multiline": false,
                "value": "USR-004",
                "display_name": "User ID",
                "info": "Enter a user ID (e.g., USR-001 through USR-010). The agent will fetch their data from the mock APIs."
              }
            },
            "outputs": [
              {
                "name": "text",
                "display_name": "User ID",
                "method": "text_response",
                "types": ["Message"]
              }
            ]
          }
        }
      },
      {
        "id": "Prompt-USAGE-TOOL",
        "type": "genericNode",
        "position": {"x": 500, "y": 150},
        "data": {
          "id": "Prompt-USAGE-TOOL",
          "display_name": "Tool: Fetch Usage Data",
          "description": "Simulates fetching product usage data from Mixpanel API",
          "type": "Prompt",
          "node": {
            "base_classes": ["Message"],
            "display_name": "Tool: Fetch Usage Data",
            "description": "Mock tool that simulates a Mixpanel API call to get usage data",
            "icon": "wrench",
            "template": {
              "_type": "Component",
              "template": {
                "type": "str",
                "required": true,
                "show": true,
                "multiline": true,
                "value": "TOOL CALL: Mixpanel Usage API\nEndpoint: GET /api/v1/users/{user_id}/usage\nUser ID: {user_id}\n\nRESPONSE (200 OK):\n{usage_data}",
                "display_name": "API Call Template"
              },
              "user_id": {
                "type": "str",
                "required": true,
                "show": true,
                "value": "",
                "display_name": "User ID",
                "input_types": ["Message"]
              },
              "usage_data": {
                "type": "str",
                "required": false,
                "show": true,
                "multiline": true,
                "value": "{\n  \"user_id\": \"USR-004\",\n  \"trial_start_date\": \"2026-02-17\",\n  \"trial_day\": 12,\n  \"total_logins\": 14,\n  \"login_streak_days\": 10,\n  \"projects_created\": 3,\n  \"team_members_invited\": 8,\n  \"features_activated\": [\n    \"project_creation\",\n    \"team_invite\",\n    \"analytics_dashboards\",\n    \"jira_integration\",\n    \"time_tracking\",\n    \"custom_views\"\n  ],\n  \"avg_session_duration_min\": 28,\n  \"total_actions_taken\": 342,\n  \"collaboration_score\": 0.85,\n  \"feature_adoption_rate\": 0.75,\n  \"last_login\": \"2026-02-28T14:30:00Z\",\n  \"most_used_feature\": \"analytics_dashboards\",\n  \"api_integrations_active\": [\"jira\"],\n  \"mobile_app_installed\": true\n}",
                "display_name": "Mock Usage Data",
                "info": "This simulates the API response. In production, this would be a real API call."
              }
            },
            "outputs": [
              {
                "name": "prompt",
                "display_name": "Usage Data",
                "method": "build_prompt",
                "types": ["Message"]
              }
            ]
          }
        }
      },
      {
        "id": "Prompt-BILLING-TOOL",
        "type": "genericNode",
        "position": {"x": 500, "y": 500},
        "data": {
          "id": "Prompt-BILLING-TOOL",
          "display_name": "Tool: Fetch Billing Data",
          "description": "Simulates fetching billing signals from Stripe API",
          "type": "Prompt",
          "node": {
            "base_classes": ["Message"],
            "display_name": "Tool: Fetch Billing Data",
            "description": "Mock tool that simulates a Stripe API call to get billing signals",
            "icon": "wrench",
            "template": {
              "_type": "Component",
              "template": {
                "type": "str",
                "required": true,
                "show": true,
                "multiline": true,
                "value": "TOOL CALL: Stripe Billing API\nEndpoint: GET /api/v1/users/{user_id}/billing\nUser ID: {user_id}\n\nRESPONSE (200 OK):\n{billing_data}",
                "display_name": "API Call Template"
              },
              "user_id": {
                "type": "str",
                "required": true,
                "show": true,
                "value": "",
                "display_name": "User ID",
                "input_types": ["Message"]
              },
              "billing_data": {
                "type": "str",
                "required": false,
                "show": true,
                "multiline": true,
                "value": "{\n  \"user_id\": \"USR-004\",\n  \"pricing_page_visits\": 3,\n  \"pricing_page_visit_dates\": [\"2026-02-22\", \"2026-02-25\", \"2026-02-27\"],\n  \"plan_comparison_views\": 2,\n  \"plans_compared\": [\"Pro\", \"Enterprise\"],\n  \"payment_method_added\": false,\n  \"discount_code_attempted\": true,\n  \"discount_code_used\": \"SAVE20\",\n  \"discount_code_status\": \"expired\",\n  \"billing_faq_views\": 1,\n  \"annual_vs_monthly_toggle_count\": 4,\n  \"estimated_team_size_for_billing\": 12,\n  \"cart_abandonment_events\": 1,\n  \"support_ticket_about_billing\": true,\n  \"ticket_summary\": \"Asked about annual billing discount and whether expired promo code can be honored\"\n}",
                "display_name": "Mock Billing Data",
                "info": "This simulates the Stripe API response. In production, this would be a real API call."
              }
            },
            "outputs": [
              {
                "name": "prompt",
                "display_name": "Billing Data",
                "method": "build_prompt",
                "types": ["Message"]
              }
            ]
          }
        }
      },
      {
        "id": "Prompt-COMBINE-DATA",
        "type": "genericNode",
        "position": {"x": 900, "y": 300},
        "data": {
          "id": "Prompt-COMBINE-DATA",
          "display_name": "Combine Data Sources",
          "description": "Combines usage and billing data for analysis",
          "type": "Prompt",
          "node": {
            "base_classes": ["Message"],
            "display_name": "Combine Data Sources",
            "description": "Merges data from multiple tool calls into a single analysis prompt",
            "template": {
              "_type": "Component",
              "template": {
                "type": "str",
                "required": true,
                "show": true,
                "multiline": true,
                "value": "DATA GATHERED FROM TOOLS:\n\n--- USAGE DATA (from Mixpanel) ---\n{usage}\n\n--- BILLING DATA (from Stripe) ---\n{billing}\n\nAnalyze this user's conversion likelihood based on ALL available data.",
                "display_name": "Combined Template"
              },
              "usage": {
                "type": "str",
                "required": true,
                "show": true,
                "value": "",
                "display_name": "Usage Data",
                "input_types": ["Message"]
              },
              "billing": {
                "type": "str",
                "required": true,
                "show": true,
                "value": "",
                "display_name": "Billing Data",
                "input_types": ["Message"]
              }
            },
            "outputs": [
              {
                "name": "prompt",
                "display_name": "Combined Data",
                "method": "build_prompt",
                "types": ["Message"]
              }
            ]
          }
        }
      },
      {
        "id": "OpenAIModel-ANALYZER",
        "type": "genericNode",
        "position": {"x": 1300, "y": 300},
        "data": {
          "id": "OpenAIModel-ANALYZER",
          "display_name": "Analyzer Agent",
          "description": "Analyzes combined data and recommends conversion action",
          "type": "OpenAIModel",
          "node": {
            "base_classes": ["Message"],
            "display_name": "Analyzer Agent",
            "description": "Takes data from multiple tools and produces a conversion recommendation",
            "icon": "OpenAI",
            "template": {
              "_type": "Component",
              "model_name": {
                "type": "str",
                "required": true,
                "show": true,
                "value": "gpt-4o-mini",
                "display_name": "Model Name"
              },
              "openai_api_key": {
                "type": "str",
                "required": true,
                "show": true,
                "value": "",
                "display_name": "OpenAI API Key",
                "password": true
              },
              "temperature": {
                "type": "float",
                "required": false,
                "show": true,
                "value": 0.3,
                "display_name": "Temperature"
              },
              "system_message": {
                "type": "str",
                "required": false,
                "show": true,
                "multiline": true,
                "value": "You are a Trial Conversion Analyst at NovaByte, a B2B SaaS project management platform.\n\nYou have access to data from multiple sources (usage analytics and billing signals). Analyze ALL the data and produce a structured conversion recommendation.\n\nRespond in this exact format:\n\n## CONVERSION ANALYSIS\n\n**Intent Score:** [0-100]\n**Intent Category:** [HIGH | MEDIUM | LOW | RISKY]\n**Confidence:** [0-100%]\n\n## KEY SIGNALS\n- [List the 3-5 most important signals from the data, with interpretation]\n\n## RISK FACTORS\n- [List any concerns or risks]\n\n## RECOMMENDED ACTION\n**Primary Action:** [specific action]\n**Timing:** [IMMEDIATE | THIS_WEEK | CAN_WAIT]\n**Channel:** [Email | Slack to Sales | In-app | Phone call]\n\n## REASONING\n[2-3 sentences explaining your recommendation, referencing specific data points]\n\n## WHAT NOT TO DO\n[1-2 things to avoid with this specific user]\n\nBe specific. Reference actual data points. Do not be generic.",
                "display_name": "System Message",
                "info": "Analysis prompt - modify to change how the agent interprets data"
              },
              "input_value": {
                "type": "str",
                "required": true,
                "show": true,
                "multiline": true,
                "value": "",
                "display_name": "Input",
                "input_types": ["Message"]
              }
            },
            "outputs": [
              {
                "name": "text_output",
                "display_name": "Recommendation",
                "method": "text_response",
                "types": ["Message"]
              }
            ]
          }
        }
      },
      {
        "id": "TextOutput-RECOMMENDATION",
        "type": "genericNode",
        "position": {"x": 1700, "y": 300},
        "data": {
          "id": "TextOutput-RECOMMENDATION",
          "display_name": "Conversion Recommendation",
          "description": "Final recommendation with reasoning",
          "type": "TextOutput",
          "node": {
            "base_classes": ["Message"],
            "display_name": "Conversion Recommendation",
            "description": "The agent's final conversion recommendation based on all gathered data",
            "template": {
              "_type": "Component",
              "input_value": {
                "type": "str",
                "required": true,
                "show": true,
                "multiline": true,
                "value": "",
                "display_name": "Output",
                "input_types": ["Message"]
              }
            },
            "outputs": [
              {
                "name": "text",
                "display_name": "Final Recommendation",
                "method": "text_response",
                "types": ["Message"]
              }
            ]
          }
        }
      },
      {
        "id": "Note-TOOLUSE",
        "type": "noteNode",
        "position": {"x": 100, "y": 50},
        "data": {
          "node": {
            "description": "# Tool Use Pattern: Agent-Driven Data Gathering\n\n## How this flow works:\n1. **User ID Input** → Just an ID (the agent fetches everything else)\n2. **Tool: Usage Data** → Calls Mixpanel API (mock) for product usage\n3. **Tool: Billing Data** → Calls Stripe API (mock) for billing signals\n4. **Combine** → Merges data from both tools\n5. **Analyzer Agent** → Produces structured recommendation\n\n## Key Insight:\nThe agent didn't need us to feed it data — it went and GOT it.\nThis is what separates an agent from a chatbot.\n\n## Exercise:\n- Try changing the mock data to simulate different user profiles\n- Modify the Analyzer Agent prompt to weight different signals\n- Add a third data source (e.g., support ticket data)\n\n## Bridge to Session 2: MCP\nToday we hardwired these API calls. With MCP, the agent would know which tool to call automatically — like USB-C for AI.",
            "display_name": "Instructions",
            "template": {}
          }
        }
      }
    ],
    "edges": [
      {
        "id": "edge-userid-to-usage",
        "source": "TextInput-USERID",
        "target": "Prompt-USAGE-TOOL",
        "sourceHandle": "{\"dataType\":\"TextInput\",\"id\":\"TextInput-USERID\",\"name\":\"text\",\"output_types\":[\"Message\"]}",
        "targetHandle": "{\"fieldName\":\"user_id\",\"id\":\"Prompt-USAGE-TOOL\",\"inputTypes\":[\"Message\"],\"type\":\"str\"}",
        "data": {
          "sourceHandle": {
            "dataType": "TextInput",
            "id": "TextInput-USERID",
            "name": "text",
            "output_types": ["Message"]
          },
          "targetHandle": {
            "fieldName": "user_id",
            "id": "Prompt-USAGE-TOOL",
            "inputTypes": ["Message"],
            "type": "str"
          }
        }
      },
      {
        "id": "edge-userid-to-billing",
        "source": "TextInput-USERID",
        "target": "Prompt-BILLING-TOOL",
        "sourceHandle": "{\"dataType\":\"TextInput\",\"id\":\"TextInput-USERID\",\"name\":\"text\",\"output_types\":[\"Message\"]}",
        "targetHandle": "{\"fieldName\":\"user_id\",\"id\":\"Prompt-BILLING-TOOL\",\"inputTypes\":[\"Message\"],\"type\":\"str\"}",
        "data": {
          "sourceHandle": {
            "dataType": "TextInput",
            "id": "TextInput-USERID",
            "name": "text",
            "output_types": ["Message"]
          },
          "targetHandle": {
            "fieldName": "user_id",
            "id": "Prompt-BILLING-TOOL",
            "inputTypes": ["Message"],
            "type": "str"
          }
        }
      },
      {
        "id": "edge-usage-to-combine",
        "source": "Prompt-USAGE-TOOL",
        "target": "Prompt-COMBINE-DATA",
        "sourceHandle": "{\"dataType\":\"Prompt\",\"id\":\"Prompt-USAGE-TOOL\",\"name\":\"prompt\",\"output_types\":[\"Message\"]}",
        "targetHandle": "{\"fieldName\":\"usage\",\"id\":\"Prompt-COMBINE-DATA\",\"inputTypes\":[\"Message\"],\"type\":\"str\"}",
        "data": {
          "sourceHandle": {
            "dataType": "Prompt",
            "id": "Prompt-USAGE-TOOL",
            "name": "prompt",
            "output_types": ["Message"]
          },
          "targetHandle": {
            "fieldName": "usage",
            "id": "Prompt-COMBINE-DATA",
            "inputTypes": ["Message"],
            "type": "str"
          }
        }
      },
      {
        "id": "edge-billing-to-combine",
        "source": "Prompt-BILLING-TOOL",
        "target": "Prompt-COMBINE-DATA",
        "sourceHandle": "{\"dataType\":\"Prompt\",\"id\":\"Prompt-BILLING-TOOL\",\"name\":\"prompt\",\"output_types\":[\"Message\"]}",
        "targetHandle": "{\"fieldName\":\"billing\",\"id\":\"Prompt-COMBINE-DATA\",\"inputTypes\":[\"Message\"],\"type\":\"str\"}",
        "data": {
          "sourceHandle": {
            "dataType": "Prompt",
            "id": "Prompt-BILLING-TOOL",
            "name": "prompt",
            "output_types": ["Message"]
          },
          "targetHandle": {
            "fieldName": "billing",
            "id": "Prompt-COMBINE-DATA",
            "inputTypes": ["Message"],
            "type": "str"
          }
        }
      },
      {
        "id": "edge-combine-to-analyzer",
        "source": "Prompt-COMBINE-DATA",
        "target": "OpenAIModel-ANALYZER",
        "sourceHandle": "{\"dataType\":\"Prompt\",\"id\":\"Prompt-COMBINE-DATA\",\"name\":\"prompt\",\"output_types\":[\"Message\"]}",
        "targetHandle": "{\"fieldName\":\"input_value\",\"id\":\"OpenAIModel-ANALYZER\",\"inputTypes\":[\"Message\"],\"type\":\"str\"}",
        "data": {
          "sourceHandle": {
            "dataType": "Prompt",
            "id": "Prompt-COMBINE-DATA",
            "name": "prompt",
            "output_types": ["Message"]
          },
          "targetHandle": {
            "fieldName": "input_value",
            "id": "OpenAIModel-ANALYZER",
            "inputTypes": ["Message"],
            "type": "str"
          }
        }
      },
      {
        "id": "edge-analyzer-to-output",
        "source": "OpenAIModel-ANALYZER",
        "target": "TextOutput-RECOMMENDATION",
        "sourceHandle": "{\"dataType\":\"OpenAIModel\",\"id\":\"OpenAIModel-ANALYZER\",\"name\":\"text_output\",\"output_types\":[\"Message\"]}",
        "targetHandle": "{\"fieldName\":\"input_value\",\"id\":\"TextOutput-RECOMMENDATION\",\"inputTypes\":[\"Message\"],\"type\":\"str\"}",
        "data": {
          "sourceHandle": {
            "dataType": "OpenAIModel",
            "id": "OpenAIModel-ANALYZER",
            "name": "text_output",
            "output_types": ["Message"]
          },
          "targetHandle": {
            "fieldName": "input_value",
            "id": "TextOutput-RECOMMENDATION",
            "inputTypes": ["Message"],
            "type": "str"
          }
        }
      }
    ],
    "viewport": {"x": 0, "y": 0, "zoom": 0.7}
  },
  "description": "Tool Use Pattern: Agent gathers data from multiple sources (Mixpanel usage API + Stripe billing API) before making a conversion recommendation. Demonstrates how agents fetch their own information rather than relying on pre-fed data.",
  "name": "Tool Use Pattern - NovaByte Data Gathering",
  "endpoint_name": null,
  "is_component": false,
  "last_tested_version": "1.1.0",
  "tags": ["session1", "tool-use-pattern", "novabyte"]
}
